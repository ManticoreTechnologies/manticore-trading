<!DOCTYPE html>
<html>
<head>
    <title>Manticore Trading API Documentation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background: #fff;
        }
        h1, h2, h3 {
            color: #2c3e50;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .endpoint {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
        }
        .get { background: #61affe; color: white; }
        .post { background: #49cc90; color: white; }
        .patch { background: #fca130; color: white; }
        .delete { background: #f93e3e; color: white; }
        .ws { background: #9069cd; color: white; }
        .path {
            font-family: monospace;
            font-size: 1.1em;
            color: #3498db;
        }
        .params {
            margin-left: 20px;
        }
        .param-name {
            font-family: monospace;
            color: #e83e8c;
        }
        .param-type {
            color: #6c757d;
            font-style: italic;
        }
        .response {
            background: #edf2f7;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        code {
            background: #272822;
            color: #f8f8f2;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: monospace;
        }
        pre {
            background: #272822;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .section-nav {
            background: #ffffff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            position: sticky;
            top: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 1px solid #e1e4e8;
            z-index: 1000;
        }
        .section-nav h3 {
            margin-top: 0;
            color: #1a73e8;
            font-size: 1.2em;
            border-bottom: none;
        }
        .section-nav ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .section-nav li {
            margin: 0;
            flex: 0 1 auto;
        }
        .section-nav a {
            color: #1a73e8;
            text-decoration: none;
            display: block;
            padding: 8px 16px;
            border-radius: 20px;
            background: #f1f3f4;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 0.95em;
            white-space: nowrap;
        }
        .section-nav a:hover {
            background: #e8f0fe;
            color: #1967d2;
            transform: translateY(-1px);
        }
        .section-nav a.active {
            background: #1a73e8;
            color: white;
        }
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 4px 4px 0;
        }
        .example {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .tab-container {
            margin: 20px 0;
        }
        .tab-buttons {
            margin-bottom: 10px;
        }
        .tab-button {
            padding: 8px 16px;
            border: none;
            background: #e9ecef;
            cursor: pointer;
            border-radius: 4px;
            margin-right: 5px;
        }
        .tab-button.active {
            background: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <h1>Manticore Trading API Documentation</h1>

    <div class="section-nav">
        <h3>Quick Navigation</h3>
        <ul>
            <li><a href="#auth">Authentication</a></li>
            <li><a href="#profile">Profile Management</a></li>
            <li><a href="#listings">Listings</a></li>
            <li><a href="#orders">Orders</a></li>
            <li><a href="#market">Market Data</a></li>
            <li><a href="#websockets">WebSocket Updates</a></li>
            <li><a href="#notifications">Notifications</a></li>
            <li><a href="#system">System Status</a></li>
        </ul>
    </div>

    <section id="auth">
        <h2>Authentication</h2>
        <p>
            Authentication in Manticore Trading uses Evrmore's cryptographic message signing system. This provides secure, 
            non-custodial authentication without requiring passwords. The authentication flow consists of these steps:
        </p>
        
        <ol>
            <li>Request a challenge message for your Evrmore address</li>
            <li>Sign the challenge message using your Evrmore wallet</li>
            <li>Submit the signature to receive a JWT token</li>
            <li>Include the JWT token in the Authorization header for authenticated requests</li>
        </ol>

        <div class="note">
            <strong>Security Note:</strong> Never share your private keys or sign messages from untrusted sources. 
            The challenge message will always start with "Sign this message to authenticate: " followed by a random string.
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/auth/challenge</span>
            <p>Get a challenge message to sign with your Evrmore wallet. Each challenge expires after a short period.</p>
            
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "address": "string"  // Your Evrmore address (e.g. "EUiTCqT8k33kFGsVYYLX6o6XGXrwQGoWY5")
}</pre>

                <h4>Response (200 OK):</h4>
                <pre>
{
    "challenge_id": "string",  // Unique challenge identifier (UUID)
    "message": "string",       // Message to sign (e.g. "Sign this message to authenticate: f868a308b3ddf86672edaf7c023f7470")
    "expires_at": "string"     // ISO-8601 timestamp when this challenge expires
}</pre>

                <h4>Error Responses:</h4>
                <pre>
400 Bad Request
{
    "detail": "Invalid Evrmore address format"
}

429 Too Many Requests
{
    "detail": "Too many challenge requests. Please wait before requesting another."
}</pre>
            </div>

            <div class="example">
                <h4>Example using curl:</h4>
                <pre>
curl -X POST http://localhost:8000/auth/challenge \
    -H "Content-Type: application/json" \
    -d '{"address": "EUiTCqT8k33kFGsVYYLX6o6XGXrwQGoWY5"}'</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/auth/login</span>
            <p>Exchange a signed challenge for a JWT token. The signature must be created using the Evrmore wallet corresponding to the address.</p>
            
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "challenge_id": "string",  // The challenge ID received from /auth/challenge
    "address": "string",       // Your Evrmore address
    "signature": "string"      // The cryptographic signature of the challenge message
}</pre>

                <h4>Response (200 OK):</h4>
                <pre>
{
    "token": "string"  // JWT token to use for authenticated requests
}</pre>

                <h4>Error Responses:</h4>
                <pre>
400 Bad Request
{
    "detail": "Invalid signature format"
}

401 Unauthorized
{
    "detail": "Failed to verify challenge: Invalid signature"
}

404 Not Found
{
    "detail": "Failed to verify challenge: Challenge not found"
}

410 Gone
{
    "detail": "Challenge has expired. Please request a new one."
}</pre>
            </div>

            <div class="example">
                <h4>Example using curl:</h4>
                <pre>
# First sign the message using your Evrmore wallet
SIGNATURE=$(evrmore-cli signmessage "EUiTCqT8k33kFGsVYYLX6o6XGXrwQGoWY5" "Sign this message to authenticate: f868a308b3ddf86672edaf7c023f7470")

# Then submit the signature
curl -X POST http://localhost:8000/auth/login \
    -H "Content-Type: application/json" \
    -d '{
        "challenge_id": "087367a3-c74f-4971-8f29-59fbfcd18aaf",
        "address": "EUiTCqT8k33kFGsVYYLX6o6XGXrwQGoWY5",
        "signature": "'$SIGNATURE'"
    }'</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/auth/verify</span>
            <p>Verify if a JWT token is valid and get the associated address. Use this endpoint to check token validity or get the authenticated user's address.</p>
            
            <div class="params">
                <h4>Headers Required:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>

                <h4>Response (200 OK):</h4>
                <pre>
{
    "valid": true,
    "address": "string"  // The Evrmore address associated with the token
}</pre>

                <h4>Error Responses:</h4>
                <pre>
401 Unauthorized
{
    "detail": "Invalid authentication credentials"
}

401 Unauthorized
{
    "detail": "Token has expired"
}</pre>
            </div>

            <div class="example">
                <h4>Example using curl:</h4>
                <pre>
curl -X GET http://localhost:8000/auth/verify \
    -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."</pre>
            </div>
        </div>

        <div class="note">
            <strong>JWT Token Usage:</strong><br>
            After obtaining a JWT token, include it in the Authorization header for all authenticated requests:
            <pre>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</pre>
            Tokens are valid for a limited time. If a token expires, request a new challenge and repeat the authentication process.
        </div>
    </section>

    <section id="profile">
        <h2>Profile Management</h2>
        <p>Manage user profiles and preferences. All endpoints require authentication.</p>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/profile</span>
            <p>Get the authenticated user's profile</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "address": "string",
    "friendly_name": "string",
    "bio": "string",
    "profile_ipfs": "string",
    "status": "string",
    "favorite_assets": ["string"]
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method patch">PATCH</span>
            <span class="path">/profile</span>
            <p>Update profile information</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "friendly_name": "string",  // optional
    "bio": "string",           // optional
    "profile_ipfs": "string"   // optional
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/profile/image</span>
            <p>Upload a profile image</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                    <li><span class="param-name">Content-Type</span>: multipart/form-data</li>
                </ul>
                <h4>Form Data:</h4>
                <ul>
                    <li><span class="param-name">file</span>: Image file (jpg/png)</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "ipfs_hash": "string"
}</pre>
            </div>
        </div>
    </section>

    <section id="listings">
        <h2>Listings</h2>
        <p>Create and manage listings. Most endpoints require authentication.</p>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/listings</span>
            <p>Create a new listing</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "seller_address": "string",
    "name": "string",
    "description": "string",
    "image_ipfs_hash": "string",  // optional
    "prices": [{
        "asset_name": "string",
        "price_evr": "decimal",
        "units": "integer"
    }],
    "tags": ["string"]  // optional
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "id": "uuid",
    "seller_address": "string",
    "listing_address": "string",
    "deposit_address": "string",
    "name": "string",
    "description": "string",
    "image_ipfs_hash": "string",
    "status": "string",
    "created_at": "string",
    "updated_at": "string",
    "prices": [{
        "asset_name": "string",
        "price_evr": "string",
        "units": "integer",
        "created_at": "string",
        "updated_at": "string"
    }],
    "balances": [{
        "asset_name": "string",
        "confirmed_balance": "string",
        "pending_balance": "string",
        "units": "integer",
        "last_confirmed_tx_hash": "string",
        "last_confirmed_tx_time": "string"
    }]
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/listings/search</span>
            <p>Search listings with filters</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">search_term</span>: Text search</li>
                    <li><span class="param-name">seller_address</span>: Filter by seller</li>
                    <li><span class="param-name">asset_name</span>: Filter by asset</li>
                    <li><span class="param-name">min_price_evr</span>: Minimum price</li>
                    <li><span class="param-name">max_price_evr</span>: Maximum price</li>
                    <li><span class="param-name">status</span>: Listing status</li>
                    <li><span class="param-name">tags</span>: Filter by tags</li>
                    <li><span class="param-name">per_page</span>: Results per page</li>
                    <li><span class="param-name">page</span>: Page number</li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/listings/featured</span>
            <p>Get featured listings with pagination</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">per_page</span>: Results per page (default: 10)</li>
                    <li><span class="param-name">page</span>: Page number (default: 1)</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "listings": [{
        "id": "string",
        "seller_address": "string",
        "name": "string",
        "description": "string",
        "image_ipfs_hash": "string",
        "status": "string",
        "created_at": "string",
        "updated_at": "string",
        "prices": [...]
    }],
    "total_count": "integer",
    "total_pages": "integer",
    "current_page": "integer",
    "limit": "integer",
    "offset": "integer"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/listings/trending</span>
            <p>Get trending listings based on views, orders, and sales</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">timeframe</span>: Time window (1h/24h/7d/30d)</li>
                    <li><span class="param-name">per_page</span>: Results per page (default: 10)</li>
                    <li><span class="param-name">page</span>: Page number (default: 1)</li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/listings/new</span>
            <p>Get newest listings within a time window</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">hours</span>: Time window in hours (default: 24, max: 168)</li>
                    <li><span class="param-name">per_page</span>: Results per page (default: 10)</li>
                    <li><span class="param-name">page</span>: Page number (default: 1)</li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/listings/home</span>
            <p>Get featured, trending, and new listings for the home page</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">featured_count</span>: Number of featured listings (default: 5)</li>
                    <li><span class="param-name">trending_count</span>: Number of trending listings (default: 10)</li>
                    <li><span class="param-name">new_count</span>: Number of new listings (default: 10)</li>
                    <li><span class="param-name">trending_timeframe</span>: Time window for trending (1h/24h/7d/30d)</li>
                    <li><span class="param-name">new_hours</span>: Time window for new listings in hours (default: 24)</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "featured": {
        "listings": [...],
        "total": "integer"
    },
    "trending": {
        "listings": [...],
        "total": "integer",
        "timeframe": "string"
    },
    "new": {
        "listings": [...],
        "total": "integer",
        "time_window_hours": "integer"
    }
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/listings/{listing_id}/pause</span>
            <p>Temporarily pause a listing from accepting new orders</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "listing_id": "string",
    "status": "paused",
    "paused_at": "string"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/listings/{listing_id}/resume</span>
            <p>Resume a paused listing</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "listing_id": "string",
    "status": "active",
    "resumed_at": "string"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/listings/{listing_id}/analytics</span>
            <p>Get detailed analytics about listing performance</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">start_date</span>: Optional start date for analytics period</li>
                    <li><span class="param-name">end_date</span>: Optional end date for analytics period</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "views": "integer",
    "unique_views": "integer",
    "sales_count": "integer",
    "total_revenue": "decimal",
    "conversion_rate": "float",
    "avg_time_to_sale": "float",
    "popular_payment_methods": {
        "asset_name": "count"
    },
    "sales_by_day": {
        "date": "count"
    }
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/listings/batch-update</span>
            <p>Update multiple listings at once</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "listing_ids": ["string"],
    "updates": {
        "field": "value"
    }
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "total": "integer",
    "successful": "integer",
    "failed": "integer",
    "results": {
        "listing_id": {
            "success": "boolean",
            "error": "string"
        }
    }
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/listings/{listing_id}/withdraw</span>
            <p>Withdraw assets from a listing to the seller's address. Only the listing owner can withdraw assets.</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "asset_name": "string",  // The asset to withdraw (e.g. "EVR", "BTC")
    "amount": "decimal"      // The amount to withdraw
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "transaction_id": "string",  // The blockchain transaction ID
    "asset_name": "string",     // The withdrawn asset
    "amount": "decimal",        // The withdrawn amount
    "to_address": "string",     // The destination address (seller's address)
    "status": "string",         // Transaction status
    "timestamp": "string"       // ISO-8601 timestamp
}</pre>
                <h4>Error Responses:</h4>
                <pre>
400 Bad Request
{
    "detail": "Insufficient balance"
}

403 Forbidden
{
    "detail": "Not authorized to withdraw from this listing"
}

404 Not Found
{
    "detail": "Listing {listing_id} not found"
}</pre>
            </div>
            <div class="example">
                <h4>Example using curl:</h4>
                <pre>
curl -X POST http://localhost:8000/listings/550e8400-e29b-41d4-a716-446655440000/withdraw \
    -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." \
    -H "Content-Type: application/json" \
    -d '{
        "asset_name": "EVR",
        "amount": 100.0
    }'</pre>
            </div>
        </div>
    </section>

    <section id="orders">
        <h2>Orders</h2>
        <p>Create and manage orders. Most endpoints require authentication.</p>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/orders/create/{listing_id}</span>
            <p>Create a new order for a listing</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "buyer_address": "string",
    "items": [
        {
            "asset_name": "string",
            "amount": "decimal"
        }
    ]
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "id": "string",
    "listing_id": "string",
    "buyer_address": "string",
    "payment_address": "string",
    "status": "string",
    "created_at": "string",
    "items": [
        {
            "asset_name": "string",
            "amount": "decimal",
            "price_evr": "decimal"
        }
    ],
    "total_price_evr": "decimal"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/orders/cart</span>
            <p>Create a cart order for multiple listings</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "buyer_address": "string",
    "items": [
        {
            "listing_id": "string",
            "asset_name": "string",
            "amount": "decimal"
        }
    ]
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/orders/{order_id}</span>
            <p>Get order details by ID</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/orders/{order_id}/balances</span>
            <p>Get order payment balances</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "EVR": {
        "confirmed_balance": "decimal",
        "pending_balance": "decimal"
    }
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/orders/{order_id}/cancel</span>
            <p>Cancel a pending order</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "status": "cancelled"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/orders/{order_id}/dispute</span>
            <p>Create a dispute for an order</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Request Body:</h4>
                <pre>
{
    "reason": "string",
    "description": "string",
    "evidence": {
        "files": ["string"],
        "notes": "string"
    }
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "dispute_id": "string",
    "status": "opened"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/orders/{order_id}/history</span>
            <p>Get order history and status changes</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "order_id": "string",
    "history": [
        {
            "id": "string",
            "status": "string",
            "description": "string",
            "details": {},
            "created_at": "string"
        }
    ]
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/orders/disputes</span>
            <p>List disputes for orders</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">order_id</span>: Filter by order ID</li>
                    <li><span class="param-name">status</span>: Filter by dispute status</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "disputes": [
        {
            "id": "string",
            "order_id": "string",
            "reason": "string",
            "description": "string",
            "status": "string",
            "created_at": "string",
            "resolved_at": "string",
            "resolution": "string"
        }
    ]
}</pre>
            </div>
        </div>
    </section>

    <section id="market">
        <h2>Market Data</h2>
        <p>Get market statistics and trends.</p>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/market/stats</span>
            <p>Get market-wide statistics</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">start_date</span>: Optional start date for stats period</li>
                    <li><span class="param-name">end_date</span>: Optional end date for stats period</li>
                </ul>
                <h4>Response:</h4>
                <pre>
{
    "total_listings": "integer",
    "active_listings": "integer",
    "total_sales": "integer",
    "total_volume": "decimal",
    "unique_sellers": "integer",
    "unique_buyers": "integer",
    "avg_sale_price": "decimal",
    "popular_payment_methods": {
        "asset_name": "count"
    },
    "sales_by_day": {
        "date": "count"
    }
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/market/trending</span>
            <p>Get currently trending items based on views and sales</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">category</span>: Optional category to filter by</li>
                    <li><span class="param-name">time_frame</span>: Time frame for trend calculation (24h/7d/30d)</li>
                </ul>
                <h4>Response:</h4>
                <pre>
[
    {
        "listing_id": "string",
        "title": "string",
        "price_evr": "decimal",
        "views_24h": "integer",
        "sales_24h": "integer",
        "trend_score": "float"
    }
]</pre>
            </div>
        </div>
    </section>

    <section id="system">
        <h2>System Status</h2>
        <p>System health and rate limit information.</p>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/system/health</span>
            <p>Get system health status</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "status": "healthy",
    "version": "string",
    "uptime": "integer",
    "database": "connected",
    "blockchain": "synced"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/system/limits</span>
            <p>Get current rate limits and usage</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "endpoint": {
        "endpoint": "string",
        "limit": "integer",
        "remaining": "integer",
        "reset_time": "string",
        "current_usage": "integer"
    }
}</pre>
            </div>
        </div>
    </section>

    <section id="websockets">
        <h2>WebSocket Updates</h2>
        <p>Real-time updates for listings, orders, market data, and chat messages</p>

        <div class="endpoint">
            <span class="method ws">WS</span>
            <span class="path">/ws/listings</span>
            <p>Receive real-time listing updates</p>
            <div class="params">
                <h4>Message Types:</h4>
                <ul>
                    <li>New Listing Created:
                        <pre>
{
    "type": "update",
    "channel": "listings",
    "data": {
        "update_type": "new",
        "listing": {...}
    }
}</pre>
                    </li>
                    <li>Listing Updated:
                        <pre>
{
    "type": "update",
    "channel": "listings",
    "data": {
        "update_type": "modified",
        "listing_id": "string",
        "changes": {...}
    }
}</pre>
                    </li>
                    <li>Listing Status Changed:
                        <pre>
{
    "type": "update",
    "channel": "listings",
    "data": {
        "listing_id": "string",
        "update_type": "status",
        "old_status": "string",
        "new_status": "string"
    }
}</pre>
                    </li>
                    <li>Balance Update:
                        <pre>
{
    "type": "update",
    "channel": "listings",
    "data": {
        "listing_id": "string",
        "update_type": "balance",
        "balances": {
            "asset_name": {
                "confirmed_balance": "string",
                "pending_balance": "string"
            }
        }
    }
}</pre>
                    </li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method ws">WS</span>
            <span class="path">/ws/orders</span>
            <p>Receive real-time order updates</p>
            <div class="params">
                <h4>Message Types:</h4>
                <ul>
                    <li>New Order:
                        <pre>
{
    "type": "update",
    "channel": "orders",
    "data": {
        "update_type": "new",
        "order": {...}
    }
}</pre>
                    </li>
                    <li>Order Status Update:
                        <pre>
{
    "type": "update",
    "channel": "orders",
    "data": {
        "order_id": "string",
        "update_type": "status",
        "old_status": "string",
        "new_status": "string"
    }
}</pre>
                    </li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method ws">WS</span>
            <span class="path">/ws/market</span>
            <p>Receive market data updates</p>
            <div class="params">
                <h4>Message Types:</h4>
                <ul>
                    <li>Price Update:
                        <pre>
{
    "type": "update",
    "channel": "market",
    "data": {
        "update_type": "price",
        "asset_name": "string",
        "price_evr": "string",
        "change_24h": "string"
    }
}</pre>
                    </li>
                    <li>Trading Volume:
                        <pre>
{
    "type": "update",
    "channel": "market",
    "data": {
        "update_type": "volume",
        "asset_name": "string",
        "volume_24h": "string"
    }
}</pre>
                    </li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method ws">WS</span>
            <span class="path">/ws/chat</span>
            <p>WebSocket endpoint for real-time chat messages and updates</p>
            <div class="params">
                <h4>Connection Flow:</h4>
                <ol>
                    <li>Connect to the WebSocket endpoint</li>
                    <li>Send authentication message with JWT token</li>
                    <li>Start receiving and sending messages</li>
                </ol>

                <h4>Message Types:</h4>
                <ul>
                    <li>Authentication:
                        <pre>
{
    "type": "auth",
    "data": {
        "token": "string"  // JWT token from /auth/login
    }
}</pre>
                    </li>
                    <li>Chat Message:
                        <pre>
{
    "type": "chat_message",
    "data": {
        "text": "string",
        "sender": "string",
        "channel": "string",
        "type": "global" | "asset" | "direct",
        "timestamp": "string",
        "ipfs_hash": "string"  // Optional, for attachments
    }
}</pre>
                    </li>
                    <li>Channel Update:
                        <pre>
{
    "type": "channel_update",
    "data": {
        "name": "string",
        "type": "string",
        "unreadCount": number
    }
}</pre>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <section id="notifications">
        <h2>Notifications</h2>
        <p>Real-time notifications and alerts. Requires authentication.</p>

        <div class="endpoint">
            <span class="method ws">WS</span>
            <span class="path">/notifications/stream?user_address={address}</span>
            <p>WebSocket endpoint for real-time notifications</p>
            <div class="params">
                <h4>Message Types:</h4>
                <pre>
{
    "type": "notification",
    "data": {
        "id": "string",
        "type": "string",
        "title": "string",
        "message": "string",
        "data": {...},
        "created_at": "string"
    }
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/notifications/unread/{user_address}</span>
            <p>Get unread notifications</p>
            <div class="params">
                <h4>Headers:</h4>
                <ul>
                    <li><span class="param-name">Authorization</span>: Bearer {token}</li>
                </ul>
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">limit</span>: Results per page</li>
                    <li><span class="param-name">offset</span>: Pagination offset</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="chat">
        <h2>Chat System</h2>
        <p>Real-time chat system supporting global chat, asset-specific channels, and direct messages.</p>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/global</span>
            <p>Get global chat messages</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">limit</span>: Number of messages (default: 20)</li>
                    <li><span class="param-name">before</span>: Timestamp for pagination</li>
                </ul>
                <h4>Response:</h4>
                <pre>
[{
    "id": "string",
    "text": "string",
    "sender": "string",
    "timestamp": "string",
    "type": "global",
    "edited": boolean,
    "deleted": boolean,
    "reactions": {
        "emoji": ["address"]
    }
}]</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/global</span>
            <p>Send a message to global chat</p>
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "text": "string",
    "ipfs_hash": "string"  // Optional, for attachments
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/assets/channels</span>
            <p>Get all available asset channels</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "channels": [{
        "name": "string",
        "type": "asset",
        "participants": number,
        "lastMessage": "string"
    }]
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/assets/{asset_name}/messages</span>
            <p>Get messages for a specific asset channel</p>
            <div class="params">
                <h4>Query Parameters:</h4>
                <ul>
                    <li><span class="param-name">limit</span>: Number of messages (default: 20)</li>
                    <li><span class="param-name">before</span>: Timestamp for pagination</li>
                </ul>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/assets/{asset_name}/messages</span>
            <p>Send a message to an asset channel</p>
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "text": "string",
    "ipfs_hash": "string"  // Optional, for attachments
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/assets/{asset_name}/subscribe</span>
            <p>Subscribe to an asset channel</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "success": boolean
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/assets/{asset_name}/unsubscribe</span>
            <p>Unsubscribe from an asset channel</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "success": boolean
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/channels</span>
            <p>Get all channels the user is subscribed to</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "channels": [{
        "name": "string",
        "type": "global" | "asset" | "direct",
        "unreadCount": number,
        "lastMessage": "string"
    }]
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/channels/{channel_name}</span>
            <p>Get information about a specific channel</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "name": "string",
    "type": "string",
    "participants": number,
    "description": "string",
    "rules": "string"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method delete">DELETE</span>
            <span class="path">/chat/messages/{message_id}</span>
            <p>Delete a message (only sender can delete)</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "success": boolean
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method patch">PATCH</span>
            <span class="path">/chat/messages/{message_id}</span>
            <p>Edit a message (only sender can edit)</p>
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "text": "string"
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "success": boolean
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/messages/{message_id}/report</span>
            <p>Report a message</p>
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "reason": "string"
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "success": boolean
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/attachments</span>
            <p>Upload a file attachment</p>
            <div class="params">
                <h4>Request Body:</h4>
                <p>multipart/form-data with file</p>
                <h4>Response:</h4>
                <pre>
{
    "ipfs_hash": "string",
    "url": "string"
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/attachments/{ipfs_hash}</span>
            <p>Get information about an attachment</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "ipfs_hash": "string",
    "url": "string",
    "type": "string",
    "size": number
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method get">GET</span>
            <span class="path">/chat/channels/{channel_name}/presence</span>
            <p>Get online users in a channel</p>
            <div class="params">
                <h4>Response:</h4>
                <pre>
{
    "online_users": ["string"]  // Array of addresses
}</pre>
            </div>
        </div>

        <div class="endpoint">
            <span class="method post">POST</span>
            <span class="path">/chat/presence</span>
            <p>Update user presence status</p>
            <div class="params">
                <h4>Request Body:</h4>
                <pre>
{
    "status": "online" | "away" | "offline"
}</pre>
                <h4>Response:</h4>
                <pre>
{
    "success": boolean
}</pre>
            </div>
        </div>
    </section>

    <script>
        // Add smooth scrolling to navigation links
        document.querySelectorAll('.section-nav a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Highlight current section in navigation
        window.addEventListener('scroll', () => {
            let current = '';
            document.querySelectorAll('section').forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 60) {
                    current = section.getAttribute('id');
                }
            });

            document.querySelectorAll('.section-nav a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href').substring(1) === current) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>


